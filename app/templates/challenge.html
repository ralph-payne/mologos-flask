{% extends "base.html" %}

{% block title %}
    Challenge
{% endblock %}

{% block page_content %}

<div id="challenge-table">
    <form id="challenge-form" action="/challenge" method="POST">
        <table>
            <thead>
                <tr>
                    <th>Example</th>
                    <th></th>
                    <th></th>
                    <th></th>
                </tr>
            </thead>

            <tbody>
                {% for word in list_of_words %}
                    <tr>
                        <td>
                            {{ word.first_half_sentence }}
                                <input type="hidden" id="target-word" name="target_word" value="{{ target_word }}">
                                <input type="hidden" id="star-boolean" name="star_boolean" value="0">
                                <input id="user-guess" name="user_guess" placeholder="Write guess...">
                            {{ word.second_half_sentence }}
                        </td>
                        <!-- <td><a href="http://facebook.com" target="_blank"><i class="fa fa-edit fa-2x"></i></a></td> -->
                        <td><a href="{{ url_for('main.edit', id=word.id) }}" target="_blank" ><i class="fa fa-edit fa-2x"></i></a></td>                        
                        <td><a href="#"><i class="fa fa-eye-slash fa-2x"></i></a></td>
                        <td><a href="#" target="_blank"><i class="fa fa-star fa-2x"></i></a></td>
                    <tr>
                {% endfor %}
            </tbody>
        </table>
        <button id="submit" class="btn btn-outline-success my-2 my-sm-0" type="submit">Submit</button>
    </form>
</div>

<script type="text/javascript">

    let userGuess = document.querySelector('#user-guess')
    let submitBtn = document.querySelector('#submit')
    let attempts = document.querySelector('#attempts')
    let attemptsContainer = document.querySelector('#attempts-container')
    let targetWord = document.querySelector('#target-word')

    // You've got the form, now make sure that the attempts work as well
    document.getElementById("challenge-form").addEventListener("submit", function(event){
        if (userGuess.value.toLowerCase() !== targetWord.value.toLowerCase()) {
            attempts.value++
            // Display the container tracking attempts
            attemptsContainer.style.display = 'block';
            event.preventDefault();
        } else {
            // Else user has guessed correctly
            return true
        }
    });

</script>
           
{% endblock %}